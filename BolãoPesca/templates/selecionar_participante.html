<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Selecionar Participante - Bol√£o dos Pescadores</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/palpites.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo-container">
                <i class="fas fa-fish logo-icon"></i>
                <h1 class="logo">Bol√£o dos Pescadores</h1>
            </div>
            <nav class="nav-menu">
                <a href="{{ url_for('index') }}" class="nav-link">
                    <i class="fas fa-home"></i> In√≠cio
                </a>
                <a href="{{ url_for('selecionar_participante') }}" class="nav-link active">
                    <i class="fas fa-users"></i> Selecionar Participante
                </a>
            </nav>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Page Header -->
            <div class="page-header">
                <div>
                    <h1><i class="fas fa-user-friends"></i> Selecionar Participante</h1>
                    <p class="page-subtitle">
                        Escolha qual participante vai fazer palpites
                    </p>
                </div>
            </div>

            <!-- Flash Messages -->
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    <div class="flash-messages">
                        {% for category, message in messages %}
                            <div class="flash flash-{{ category }}">
                                {{ message }}
                                <button class="flash-close" onclick="this.parentElement.remove()">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        {% endfor %}
                    </div>
                {% endif %}
            {% endwith %}

            <!-- Participante Atual -->
            {% if participante_atual %}
            <div class="current-user-card">
                <div class="current-user-header">
                    <h3><i class="fas fa-user-check"></i> Participante Atual</h3>
                </div>
                <div class="current-user-body">
                    <div class="user-avatar-large">
                        {% if participante_atual.apelido %}
                            {{ participante_atual.apelido|first|upper }}
                        {% else %}
                            {{ participante_atual.nome|first|upper }}
                        {% endif %}
                    </div>
                    <div class="user-info">
                        <h4>{{ participante_atual.nome }}</h4>
                        {% if participante_atual.apelido %}
                            <p class="user-nickname">@{{ participante_atual.apelido }}</p>
                        {% endif %}
                        <div class="user-stats">
                            <span class="stat">
                                <i class="fas fa-trophy"></i>
                                {{ participante_atual.get('pontos', 0) }} pontos
                            </span>
                            <span class="stat">
                                <i class="fas fa-star"></i>
                                {{ participante_atual.get('placares_exatos', 0) }} PE
                            </span>
                            <span class="stat">
                                <i class="fas fa-check"></i>
                                {{ participante_atual.get('pontos_time', 0) }} PTE
                            </span>
                        </div>
                    </div>
                    <div class="user-actions">
                        <a href="{{ url_for('palpites') }}" class="btn-primary">
                            <i class="fas fa-edit"></i> Continuar Palpitando
                        </a>
                        <a href="{{ url_for('logout_participante') }}" class="btn-secondary">
                            <i class="fas fa-sign-out-alt"></i> Trocar Participante
                        </a>
                    </div>
                </div>
            </div>
            {% endif %}

            <!-- Lista de Participantes -->
            <div class="participants-grid">
                <div class="section-header">
                    <h3><i class="fas fa-users"></i> Todos os Participantes</h3>
                    <p class="section-subtitle">Clique em um participante para fazer palpites</p>
                </div>

                {% if participants %}
                    <div class="participants-list">
                        {% for participante in participants %}
                        <div class="participant-card {% if participante_atual and participante.id == participante_atual.id %}current{% endif %}">
                            <div class="participant-header">
                                <div class="participant-avatar">
                                    {% if participante.apelido %}
                                        {{ participante.apelido|first|upper }}
                                    {% else %}
                                        {{ participante.nome|first|upper }}
                                    {% endif %}
                                </div>
                                <div class="participant-rank">
                                    <span class="rank-badge">
                                        {% set rank = loop.index %}
                                        {% if rank == 1 %}ü•á
                                        {% elif rank == 2 %}ü•à
                                        {% elif rank == 3 %}ü•â
                                        {% else %}#{{ rank }}
                                        {% endif %}
                                    </span>
                                </div>
                            </div>

                            <div class="participant-info">
                                <h4>{{ participante.nome }}</h4>
                                {% if participante.apelido %}
                                    <p class="participant-nickname">@{{ participante.apelido }}</p>
                                {% endif %}

                                <div class="participant-stats">
                                    <div class="stat-item">
                                        <i class="fas fa-trophy"></i>
                                        <span class="stat-value">{{ participante.get('pontos', 0) }}</span>
                                        <span class="stat-label">Pontos</span>
                                    </div>
                                    <div class="stat-item">
                                        <i class="fas fa-star"></i>
                                        <span class="stat-value">{{ participante.get('placares_exatos', 0) }}</span>
                                        <span class="stat-label">PE</span>
                                    </div>
                                    <div class="stat-item">
                                        <i class="fas fa-check"></i>
                                        <span class="stat-value">{{ participante.get('pontos_time', 0) }}</span>
                                        <span class="stat-label">PTE</span>
                                    </div>
                                </div>

                                <div class="participant-actions">
                                    <a href="{{ url_for('login_participante', participante_id=participante.id) }}"
                                       class="btn-select">
                                        <i class="fas fa-sign-in-alt"></i> Selecionar
                                    </a>

                                    <a href="{{ url_for('palpite_rapido', participante_id=participante.id) }}"
                                       class="btn-quick">
                                        <i class="fas fa-bolt"></i> R√°pido
                                    </a>
                                </div>
                            </div>

                            <div class="participant-status">
                                {% if participante.get('ativo', True) %}
                                    <span class="status-badge active">
                                        <i class="fas fa-check-circle"></i> Ativo
                                    </span>
                                {% else %}
                                    <span class="status-badge inactive">
                                        <i class="fas fa-times-circle"></i> Inativo
                                    </span>
                                {% endif %}
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <div class="empty-state">
                        <i class="fas fa-user-slash"></i>
                        <h3>Nenhum participante cadastrado</h3>
                        <p>Cadastre participantes primeiro para come√ßar a fazer palpites</p>
                        <a href="{{ url_for('cadastro_participantes') }}" class="btn-primary">
                            <i class="fas fa-user-plus"></i> Cadastrar Participantes
                        </a>
                    </div>
                {% endif %}
            </div>

            <!-- A√ß√µes R√°pidas -->
            <div class="quick-actions">
                <div class="action-card large">
                    <i class="fas fa-edit"></i>
                    <div class="action-content">
                        <h4>Fazer Palpites</h4>
                        <p>Selecione um participante acima para come√ßar a fazer palpites para a rodada atual</p>
                    </div>
                </div>

                <div class="action-card large">
                    <i class="fas fa-history"></i>
                    <div class="action-content">
                        <h4>Ver Todos os Palpites</h4>
                        <p>Acesso administrativo para ver palpites de todos os participantes</p>
                        <a href="{{ url_for('modo_admin') }}" class="btn-admin" onclick="return confirm('Ativar modo administrador?')">
                            <i class="fas fa-unlock"></i> Ativar Modo Admin
                        </a>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Sele√ß√£o de Participante</h3>
                    <p>Escolha quem vai fazer os palpites</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2023 Bol√£o dos Pescadores</p>
            </div>
        </footer>
    </div>

    <script>
        // Auto-remove flash messages
        setTimeout(() => {
            const flashes = document.querySelectorAll('.flash');
            flashes.forEach(flash => {
                flash.style.opacity = '0';
                setTimeout(() => flash.remove(), 300);
            });
        }, 5000);

        // Efeito hover nos cards
        document.querySelectorAll('.participant-card').forEach(card => {
            card.addEventListener('mouseenter', () => {
                card.style.transform = 'translateY(-5px)';
                card.style.boxShadow = '0 10px 25px rgba(0,0,0,0.1)';
            });

            card.addEventListener('mouseleave', () => {
                card.style.transform = 'translateY(0)';
                card.style.boxShadow = '0 4px 12px rgba(0,0,0,0.1)';
            });
        });
    </script>
</body>
</html>
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bolão dos Pescadores</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
    <div class="logo-container">
        <i class="fas fa-fish logo-icon"></i>
        <div>
            <h1 class="logo">Bolão dos Pescadores</h1>
            <p class="tagline">O bolão mais tradicional entre os amantes do futebol!</p>
        </div>
    </div>
    <nav class="nav-menu">
        <a href="{{ url_for('cadastro_participantes') }}" class="nav-link">
            <i class="fas fa-users"></i> Participantes
        </a>
        <a href="{{ url_for('cadastro_jogos') }}" class="nav-link">
            <i class="fas fa-futbol"></i> Jogos
        </a>
        {% if session.get('user_id') %}
        <a href="{{ url_for('palpites') }}" class="nav-link">
            <i class="fas fa-edit"></i> Palpites
        </a>
        <a href="{{ url_for('meus_palpites') }}" class="nav-link">
            <i class="fas fa-history"></i> Meus Palpites
        </a>
        <div class="user-info-container">
            <div class="user-badge">
                <i class="fas fa-user"></i>
                {{ session.get('user_name', 'Usuário') }}
                {% if session.get('user_apelido') %}
                    <small>({{ session.get('user_apelido') }})</small>
                {% endif %}
            </div>
            <a href="{{ url_for('selecionar_participante') }}" class="nav-link trocar-btn">
                <i class="fas fa-sync-alt"></i> Trocar
            </a>
        </div>
        {% endif %}
    </nav>
</header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Stats -->
            <div class="dashboard-stats">
    <div class="stat-card main-stat">
        <div class="stat-icon">
            <i class="fas fa-trophy"></i>
        </div>
        <div class="stat-content">
            <h3>Rodada {{ rodada.numero }}</h3>
            <p class="stat-status">{{ rodada.status }}</p>
            <p class="stat-detail">Início: {{ rodada.data_inicio }}</p>
        </div>
    </div>

    <div class="stat-card">
        <div class="stat-icon">
            <i class="fas fa-users"></i>
        </div>
        <div class="stat-content">
            <h3>Participantes</h3>
            <p class="stat-number">{{ estatisticas.total_participantes }}</p>
            <p class="stat-label">Ativos no bolão</p>
        </div>
    </div>

    <div class="stat-card">
        <div class="stat-icon">
            <i class="fas fa-chart-line"></i>
        </div>
        <div class="stat-content">
            <h3>Precisão</h3>
            <p class="stat-number">{{ estatisticas.precisao_media }}</p>
            <p class="stat-label">Média de acertos</p>
        </div>
    </div>
</div>

            </div>

            <!-- Two Columns Layout -->
            <div class="columns-container">
                <!-- Left Column: Ranking -->
                <section class="ranking-section">
                    <div class="section-header">
                        <h2><i class="fas fa-medal"></i> Ranking Geral</h2>
                        <div class="section-actions">
                            <span class="update-info">Atualizado em tempo real</span>
                            <a href="{{ url_for('cadastro_participantes') }}" class="btn-small">
                                <i class="fas fa-plus"></i> Participar
                            </a>
                        </div>
                    </div>

                    {% if ranking %}
                    <div class="ranking-table-container">
    <table class="ranking-table">
        <thead>
            <tr>
                <th>#Participante</th>
                <th>Pontos</th>
                <th>PE</th>
                <th>PTE</th>
                <th>Aproveitamento</th>
            </tr>
        </thead>
        <tbody>
            {% for participante in ranking %}
            <tr class="ranking-row {% if participante.posicao <= 3 %}top-three{% endif %}">
                <td class="position-cell">
                    <span class="position-badge">{{ participante.posicao }}</span>
                    {% if participante.posicao == 1 %}
                        <i class="fas fa-crown gold"></i>
                    {% elif participante.posicao == 2 %}
                        <i class="fas fa-medal silver"></i>
                    {% elif participante.posicao == 3 %}
                        <i class="fas fa-medal bronze"></i>
                    {% endif %}
                </td>
                <td class="name-cell">
                    <div class="avatar">
                        {% if participante.apelido %}
                            {{ participante.apelido|first|upper }}
                        {% else %}
                            {{ participante.nome|first|upper }}
                        {% endif %}
                    </div>
                    <div class="name-info">
                        <strong>{{ participante.nome }}</strong>
                        {% if participante.apelido %}
                            <small>@{{ participante.apelido }}</small>
                        {% endif %}
                        {% if participante.get('jogos_com_palpite') %}
                            <small class="palpites-count">
                                {{ participante.jogos_com_palpite }} palpites
                            </small>
                        {% endif %}
                    </div>
                </td>
                <td class="points-cell">
                    <span class="points-value">{{ participante.get('pontos', 0) }}</span>
                </td>
                <td class="pe-cell">
                    <span class="pe-value" title="Placares Exatos">
                        {{ participante.get('placares_exatos', 0) }}
                        <small class="metric-label">PE</small>
                    </span>
                </td>
                <td class="pte-cell">
                    <span class="pte-value" title="Pontos Time">
                        {{ participante.get('pontos_time', 0) }}
                        <small class="metric-label">PTE</small>
                    </span>
                </td>
                <td class="aproveitamento-cell">
                    <div class="aproveitamento-container">
                        <span class="aproveitamento-value">{{ participante.get('aproveitamento', 0) }}%</span>
                        <div class="aproveitamento-bar">
                            <div class="aproveitamento-fill"
                                 style="width: {{ min(participante.get('aproveitamento', 0), 100) }}%">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="6" class="empty-ranking">
                    <i class="fas fa-trophy"></i>
                    <p>Nenhum participante no ranking ainda</p>
                    <small>Faça palpites para aparecer no ranking</small>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

                    <div class="ranking-footer">
    <div class="ranking-legend">
        <h4><i class="fas fa-info-circle"></i> Legenda do Ranking:</h4>
        <div class="legend-items">
            <div class="legend-item">
                <span class="legend-color" style="background: linear-gradient(135deg, #ff6b6b, #ee5a52);"></span>
                <span class="legend-text">
                    <strong>PE</strong> = Placar Exato (3 pontos por acerto)
                </span>
            </div>
            <div class="legend-item">
                <span class="legend-color" style="background: linear-gradient(135deg, #4ecdc4, #44a08d);"></span>
                <span class="legend-text">
                    <strong>PTE</strong> = Placar Time Exato (1 ponto pelo placar por time)
                </span>
            </div>
            <div class="legend-item">
                <span class="legend-color" style="background: linear-gradient(90deg, var(--secondary-color), var(--primary-color));"></span>
                <span class="legend-text">
                    <strong>Aproveitamento</strong> = Pontos obtidos / Pontos possíveis
                </span>
            </div>
        </div>
    </div>

    <p>Mostrando os {{ ranking|length }} melhores de {{ estatisticas.total_participantes }} participantes</p>
    <a href="#" class="link-view-all">
        Ver ranking completo <i class="fas fa-arrow-right"></i>
    </a>
</div>
                    {% else %}
                    <div class="empty-state">
                        <i class="fas fa-trophy"></i>
                        <h3>Nenhum participante ainda</h3>
                        <p>Seja o primeiro a entrar no ranking!</p>
                        <a href="{{ url_for('cadastro_participantes') }}" class="btn-primary">
                            <i class="fas fa-user-plus"></i> Cadastrar Participante
                        </a>
                    </div>
                    {% endif %}
                </section>

                <!-- Right Column: Rodada e Ações -->
                <section class="actions-section">
                    <!-- Rodada Atual -->
                    <div class="current-round-card">
                        <div class="round-header">
                            <h3><i class="fas fa-calendar-alt"></i> Rodada Atual</h3>
                            <span class="round-badge">#{{ rodada.numero }}</span>
                        </div>

                        <div class="round-status">
    <div class="status-indicator {{ 'active' if rodada.status != 'Aguardando início' else 'waiting' }}"></div>
    <div class="status-info">
        <h4>{{ rodada.status }}</h4>
    </div>
</div>

                        {% if rodada.jogos %}
                        <div class="round-games">
                            <h4>Jogos desta rodada</h4>
                            {% for jogo in rodada.jogos %}
                            <div class="game-item">
                                <div class="teams">
                                    <span class="team">{{ jogo.time_casa }}</span>
                                    <span class="vs">vs</span>
                                    <span class="team">{{ jogo.time_visitante }}</span>
                                </div>
                                <span class="game-time">{{ jogo.horario }}</span>
                            </div>
                            {% endfor %}
                        </div>
                        {% else %}
                        <div class="no-games">
                            <i class="fas fa-futbol"></i>
                            <p>Nenhum jogo cadastrado para esta rodada</p>
                            <a href="{{ url_for('cadastro_jogos') }}" class="btn-small">
                                <i class="fas fa-plus"></i> Cadastrar Jogos
                            </a>
                        </div>
                        {% endif %}

                        <div class="round-actions">
                            <button class="btn-action" onclick="alert('Palpites serão habilitados quando houver jogos cadastrados')">
                                <i class="fas fa-edit"></i> Fazer Palpite
                            </button>
                            <a href="{{ url_for('cadastro_jogos') }}" class="btn-action secondary">
                                <i class="fas fa-eye"></i> Ver Detalhes
                            </a>
                        </div>
                    </div>

                    <!-- Últimas Atividades -->
                    <div class="activities-card">
                        <div class="activities-header">
                            <h3><i class="fas fa-history"></i> Últimas Atividades</h3>
                        </div>
                        <div class="activities-list">
                            <div class="activity-item">
                                <div class="activity-icon">
                                    <i class="fas fa-user-plus"></i>
                                </div>
                                <div class="activity-content">
                                    <p>Novo participante cadastrado</p>
                                    <small>Agora há pouco</small>
                                </div>
                            </div>
                            <div class="activity-item">
                                <div class="activity-icon">
                                    <i class="fas fa-futbol"></i>
                                </div>
                                <div class="activity-content">
                                    <p>Rodada {{ rodada.numero }} iniciada</p>
                                    <small>Hoje</small>
                                </div>
                            </div>
                            <div class="activity-item">
                                <div class="activity-icon">
                                    <i class="fas fa-trophy"></i>
                                </div>
                                <div class="activity-content">
                                    <p>Ranking atualizado</p>
                                    <small>5 minutos atrás</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="quick-actions">
                        <h3><i class="fas fa-bolt"></i> Ações Rápidas</h3>
                        <div class="action-buttons">
                            <a href="{{ url_for('cadastro_participantes') }}" class="action-btn">
                                <i class="fas fa-user-plus"></i>
                                <span>Novo Participante</span>
                            </a>
                            <a href="{{ url_for('cadastro_jogos') }}" class="action-btn">
                                <i class="fas fa-futbol"></i>
                                <span>Cadastrar Jogo</span>
                            </a>
                            <a href="#" class="action-btn" onclick="alert('Relatórios em breve!')">
                                <i class="fas fa-chart-bar"></i>
                                <span>Ver Relatórios</span>
                            </a>
                            <a href="#" class="action-btn" onclick="alert('Configurações em breve!')">
                                <i class="fas fa-cog"></i>
                                <span>Configurações</span>
                            </a>
                        </div>
                    </div>
                </section>
            </div>
        </main>

        <!-- Footer
        <footer class="footer">
            <div class="footer-content">
                <div class="footer-section">
                </div>
        </footer> -->
    </div>

    <script>
        // Simulação de atualização em tempo real
        function atualizarContador() {
            const contador = document.querySelector('.update-info');
            if (contador) {
                const agora = new Date();
                contador.textContent = `Atualizado às ${agora.getHours()}:${agora.getMinutes().toString().padStart(2, '0')}`;
            }
        }

        // Atualiza a cada minuto
        setInterval(atualizarContador, 60000);
        atualizarContador(); // Chama uma vez ao carregar

        // Animações simples para os cards
        document.querySelectorAll('.stat-card, .ranking-row').forEach(card => {
            card.addEventListener('mouseenter', () => {
                card.style.transform = 'translateY(-5px)';
            });

            card.addEventListener('mouseleave', () => {
                card.style.transform = 'translateY(0)';
            });
        });
    </script>
</body>
</html>